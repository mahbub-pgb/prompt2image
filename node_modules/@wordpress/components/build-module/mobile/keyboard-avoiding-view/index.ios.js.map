{
  "version": 3,
  "sources": ["../../../src/mobile/keyboard-avoiding-view/index.ios.js"],
  "sourcesContent": ["/**\n * External dependencies\n */\nimport { KeyboardAvoidingView as IOSKeyboardAvoidingView, Animated, Keyboard, Dimensions, View } from 'react-native';\nimport SafeArea from 'react-native-safe-area';\n\n/**\n * WordPress dependencies\n */\nimport { useEffect, useRef, useState } from '@wordpress/element';\nimport { useResizeObserver } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport useIsFloatingKeyboard from '../utils/use-is-floating-keyboard';\nimport styles from './styles.scss';\nimport { jsxs as _jsxs, jsx as _jsx } from \"react/jsx-runtime\";\nconst AnimatedKeyboardAvoidingView = Animated.createAnimatedComponent(IOSKeyboardAvoidingView);\nconst MIN_HEIGHT = 44;\nexport const KeyboardAvoidingView = ({\n  parentHeight,\n  style,\n  withAnimatedHeight = false,\n  ...otherProps\n}) => {\n  const [resizeObserver, sizes] = useResizeObserver();\n  const [isKeyboardOpen, setIsKeyboardOpen] = useState(false);\n  const [safeAreaBottomInset, setSafeAreaBottomInset] = useState(0);\n  const {\n    height = 0\n  } = sizes || {};\n  const floatingKeyboard = useIsFloatingKeyboard();\n  const animatedHeight = useRef(new Animated.Value(MIN_HEIGHT)).current;\n  const {\n    height: fullHeight\n  } = Dimensions.get('screen');\n  const keyboardVerticalOffset = fullHeight - parentHeight;\n  useEffect(() => {\n    SafeArea.getSafeAreaInsetsForRootView().then(({\n      safeAreaInsets\n    }) => {\n      setSafeAreaBottomInset(safeAreaInsets.bottom);\n    });\n    const safeAreaSubscription = SafeArea.addEventListener('safeAreaInsetsForRootViewDidChange', onSafeAreaInsetsUpdate);\n    const keyboardShowSubscription = Keyboard.addListener('keyboardWillShow', onKeyboardWillShow);\n    const keyboardHideSubscription = Keyboard.addListener('keyboardWillHide', onKeyboardWillHide);\n    return () => {\n      safeAreaSubscription.remove();\n      keyboardShowSubscription.remove();\n      keyboardHideSubscription.remove();\n    };\n    // See https://github.com/WordPress/gutenberg/pull/41166\n  }, []);\n  function onSafeAreaInsetsUpdate({\n    safeAreaInsets\n  }) {\n    setSafeAreaBottomInset(safeAreaInsets.bottom);\n  }\n  function onKeyboardWillShow({\n    endCoordinates\n  }) {\n    setIsKeyboardOpen(true);\n    animatedHeight.setValue(endCoordinates.height + MIN_HEIGHT);\n  }\n  function onKeyboardWillHide({\n    duration,\n    startCoordinates\n  }) {\n    // The startCoordinates.height is set to wrong value when we use cmd + k for hide the keyboard (Have no idea why).\n    // Because of that the `setIsKeyboardOpened` is not invoked and the state of keyboard is wrong.\n    // The keyboardIsOpenBreakpoint use 100 as a fallback if the startCoordinates.height is too small (cmd + k case)\n    const keyboardIsOpenBreakpoint = startCoordinates.height > 100 ? startCoordinates.height / 3 : 100;\n    const animatedListenerId = animatedHeight.addListener(({\n      value\n    }) => {\n      if (value < keyboardIsOpenBreakpoint) {\n        setIsKeyboardOpen(false);\n      }\n    });\n    Animated.timing(animatedHeight, {\n      toValue: MIN_HEIGHT,\n      duration,\n      useNativeDriver: false\n    }).start(() => {\n      animatedHeight.removeListener(animatedListenerId);\n    });\n  }\n  return /*#__PURE__*/_jsx(AnimatedKeyboardAvoidingView, {\n    ...otherProps,\n    enabled: !floatingKeyboard,\n    behavior: \"padding\",\n    keyboardVerticalOffset: keyboardVerticalOffset,\n    style: withAnimatedHeight ? [style, {\n      height: animatedHeight,\n      marginBottom: isKeyboardOpen ? -safeAreaBottomInset : 0\n    }] : style,\n    children: /*#__PURE__*/_jsxs(View, {\n      style: [{\n        top: -height + MIN_HEIGHT\n      }, styles.animatedChildStyle, !withAnimatedHeight && styles.defaultChildStyle],\n      children: [resizeObserver, otherProps.children]\n    })\n  });\n};\nexport default KeyboardAvoidingView;"],
  "mappings": "AAGA,SAAS,wBAAwB,yBAAyB,UAAU,UAAU,YAAY,YAAY;AACtG,OAAO,cAAc;AAKrB,SAAS,WAAW,QAAQ,gBAAgB;AAC5C,SAAS,yBAAyB;AAKlC,OAAO,2BAA2B;AAClC,OAAO,YAAY;AACnB,SAAS,QAAQ,OAAO,OAAO,YAAY;AAC3C,MAAM,+BAA+B,SAAS,wBAAwB,uBAAuB;AAC7F,MAAM,aAAa;AACZ,MAAM,uBAAuB,CAAC;AAAA,EACnC;AAAA,EACA;AAAA,EACA,qBAAqB;AAAA,EACrB,GAAG;AACL,MAAM;AACJ,QAAM,CAAC,gBAAgB,KAAK,IAAI,kBAAkB;AAClD,QAAM,CAAC,gBAAgB,iBAAiB,IAAI,SAAS,KAAK;AAC1D,QAAM,CAAC,qBAAqB,sBAAsB,IAAI,SAAS,CAAC;AAChE,QAAM;AAAA,IACJ,SAAS;AAAA,EACX,IAAI,SAAS,CAAC;AACd,QAAM,mBAAmB,sBAAsB;AAC/C,QAAM,iBAAiB,OAAO,IAAI,SAAS,MAAM,UAAU,CAAC,EAAE;AAC9D,QAAM;AAAA,IACJ,QAAQ;AAAA,EACV,IAAI,WAAW,IAAI,QAAQ;AAC3B,QAAM,yBAAyB,aAAa;AAC5C,YAAU,MAAM;AACd,aAAS,6BAA6B,EAAE,KAAK,CAAC;AAAA,MAC5C;AAAA,IACF,MAAM;AACJ,6BAAuB,eAAe,MAAM;AAAA,IAC9C,CAAC;AACD,UAAM,uBAAuB,SAAS,iBAAiB,sCAAsC,sBAAsB;AACnH,UAAM,2BAA2B,SAAS,YAAY,oBAAoB,kBAAkB;AAC5F,UAAM,2BAA2B,SAAS,YAAY,oBAAoB,kBAAkB;AAC5F,WAAO,MAAM;AACX,2BAAqB,OAAO;AAC5B,+BAAyB,OAAO;AAChC,+BAAyB,OAAO;AAAA,IAClC;AAAA,EAEF,GAAG,CAAC,CAAC;AACL,WAAS,uBAAuB;AAAA,IAC9B;AAAA,EACF,GAAG;AACD,2BAAuB,eAAe,MAAM;AAAA,EAC9C;AACA,WAAS,mBAAmB;AAAA,IAC1B;AAAA,EACF,GAAG;AACD,sBAAkB,IAAI;AACtB,mBAAe,SAAS,eAAe,SAAS,UAAU;AAAA,EAC5D;AACA,WAAS,mBAAmB;AAAA,IAC1B;AAAA,IACA;AAAA,EACF,GAAG;AAID,UAAM,2BAA2B,iBAAiB,SAAS,MAAM,iBAAiB,SAAS,IAAI;AAC/F,UAAM,qBAAqB,eAAe,YAAY,CAAC;AAAA,MACrD;AAAA,IACF,MAAM;AACJ,UAAI,QAAQ,0BAA0B;AACpC,0BAAkB,KAAK;AAAA,MACzB;AAAA,IACF,CAAC;AACD,aAAS,OAAO,gBAAgB;AAAA,MAC9B,SAAS;AAAA,MACT;AAAA,MACA,iBAAiB;AAAA,IACnB,CAAC,EAAE,MAAM,MAAM;AACb,qBAAe,eAAe,kBAAkB;AAAA,IAClD,CAAC;AAAA,EACH;AACA,SAAoB,qBAAK,8BAA8B;AAAA,IACrD,GAAG;AAAA,IACH,SAAS,CAAC;AAAA,IACV,UAAU;AAAA,IACV;AAAA,IACA,OAAO,qBAAqB,CAAC,OAAO;AAAA,MAClC,QAAQ;AAAA,MACR,cAAc,iBAAiB,CAAC,sBAAsB;AAAA,IACxD,CAAC,IAAI;AAAA,IACL,UAAuB,sBAAM,MAAM;AAAA,MACjC,OAAO,CAAC;AAAA,QACN,KAAK,CAAC,SAAS;AAAA,MACjB,GAAG,OAAO,oBAAoB,CAAC,sBAAsB,OAAO,iBAAiB;AAAA,MAC7E,UAAU,CAAC,gBAAgB,WAAW,QAAQ;AAAA,IAChD,CAAC;AAAA,EACH,CAAC;AACH;AACA,IAAO,oBAAQ;",
  "names": []
}
